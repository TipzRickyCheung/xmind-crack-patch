(global.webpackChunkxmind_vana=global.webpackChunkxmind_vana||[]).push([[7849,623],{9342:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var n=i(23645),o=i.n(n)()((function(e){return e[1]}));o.push([e.id,".presentation-container[data-v-54c5b1d2] {\n  width: 100%;\n  height: 100%;\n  position: relative;\n  transition: opacity 200ms ease;\n}\n.presentation-container .mask[data-v-54c5b1d2] {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  z-index: 2;\n  left: 0;\n  right: 0;\n}\n",""]);const r=o},48183:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var n=i(23645),o=i.n(n)()((function(e){return e[1]}));o.push([e.id,"body[data-v-0ced2574],\n#app[data-v-0ced2574] {\n  background: black;\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  padding: 0;\n  margin: 0;\n  overflow: hidden;\n}\n.nocursor[data-v-0ced2574] {\n  cursor: none;\n}\n",""]);const r=o},44799:(e,t,i)=>{"use strict";i.r(t);var n=i(22244),o=i(2954),r=i(63477),l=i.n(r),s=i(52339),a=i(45133),d=i(67657),u=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function s(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};const c=(0,o.aZ)({__name:"app",setup(e){const t=(0,o.XI)(),i=(0,o.iH)(!1);{let e=d.BrowserWindow.fromId(window.id);const t=d.screen.getDisplayMatching(d.getCurrentWindow().getBounds());e.setSize(t.bounds.width,t.bounds.height),e.setFullScreen(!0)}return(0,o.bv)((()=>u(this,void 0,void 0,(function*(){const e=l().parse(window.location.search.slice(1)),n=parseInt(e.remoteId);t.value=new a.vN(n),yield new Promise((e=>setTimeout(e,200))),yield t.value.init(),i.value=!0})))),{__sfc:!0,presenter:t,initialized:i,PitchContainer:s.Z}}});i(79285);const h=(0,i(51900).Z)(c,(function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("div",{staticClass:"nocursor",attrs:{id:"app",tabindex:"-1"}},[i.initialized?t(i.PitchContainer,{style:{width:"100%",height:"100%",position:"relative"},attrs:{presenter:i.presenter}}):e._e()],1)}),[],!1,null,"0ced2574",null).exports;(0,n.Z)(h,{name:"presentation"})},40623:(e,t,i)=>{"use strict";var n;i.d(t,{v:()=>n,w:()=>o}),function(e){e.LOGICRIGHT="org.xmind.ui.logic.right",e.LOGICLEFT="org.xmind.ui.logic.left",e.TREERIGHT="org.xmind.ui.tree.right",e.TREELEFT="org.xmind.ui.tree.left",e.TREESIDED="org.xmind.ui.timeline.vertical",e.ORGCHARTDOWN="org.xmind.ui.org-chart.down",e.ORGCHARTUP="org.xmind.ui.org-chart.up",e.MAPCLOCKWISE="org.xmind.ui.map.clockwise",e.MAPANTICLOCKWISE="org.xmind.ui.map.anticlockwise",e.MAP="org.xmind.ui.map",e.MAPUNBALANCED="org.xmind.ui.map.unbalanced",e.MAPFLOATING="org.xmind.ui.map.floating",e.MAPFLOATINGCLOCKWISE="org.xmind.ui.map.floating.clockwise",e.MAPFLOATINGANTICLOCKWISE="org.xmind.ui.map.floating.anticlockwise",e.TIMELINETHROUGHVERTICAL="org.xmind.ui.timeline.through.vertical",e.TIMELINESIDEDHORIZONTAL="org.xmind.ui.timeline.sided.horizontal",e.TIMELINEHORIZONTAL="org.xmind.ui.timeline.horizontal",e.FISHBONELEFTHEADED="org.xmind.ui.fishbone.leftHeaded",e.LEFTHEADTOPBONE="org.xmind.ui.fishbone.structure.lefthead.topbone",e.LEFTHEADBOTTOMBONE="org.xmind.ui.fishbone.structure.lefthead.bottombone",e.FISHBONERIGHTHEADED="org.xmind.ui.fishbone.rightHeaded",e.RIGHTHEADTOPBONE="org.xmind.ui.fishbone.structure.righthead.topbone",e.RIGHTHEADBOTTOMBONE="org.xmind.ui.fishbone.structure.righthead.bottombone",e.SPREADSHEET="org.xmind.ui.spreadsheet",e.COLUMNSPREADSHEET="org.xmind.ui.spreadsheet.column",e.TREETABLE="org.xmind.ui.treetable",e.TOPTITLETREETABLE="org.xmind.ui.treetable.toptitle",e.SPREADSHEETROW="org.xmind.ui.structure.spreadsheet.row",e.SPREADSHEETCOLUMN="org.xmind.ui.structure.column.spreadsheet",e.FISHBONELEFTHEADTOP="org.xmind.ui.fishbone.leftHeaded.top",e.FISHBONELEFTHEADBOTTOM="org.xmind.ui.fishbone.leftHeaded.bottom",e.FISHBONERIGHTHEADTOP="org.xmind.ui.fishbone.rightHeaded.top",e.FISHBONERIGHTHEADBOTTOM="org.xmind.ui.fishbone.rightHeaded.bottom",e.TIMELINEHORIZONTALUP="org.xmind.ui.timeline.horizontal.up",e.TIMELINEHORIZONTALDOWN="org.xmind.ui.timeline.horizontal.down",e.LOGICCHARTRIGHT="org.xmind.ui.logic-chart.right",e.LOGICCHARTLEFT="org.xmind.ui.logic-chart.left",e.BRACERIGHT="org.xmind.ui.brace.right",e.BRACELEFT="org.xmind.ui.brace.left",e.TIMELINEVERTICAL="org.xmind.ui.timeline.vertical"}(n||(n={}));const o={[n.MAPUNBALANCED]:"map-unbalance",[n.MAPCLOCKWISE]:"map-clockwise",[n.LOGICRIGHT]:"logic-right",[n.LOGICLEFT]:"logic-left",[n.BRACERIGHT]:"brace-right",[n.BRACELEFT]:"brace-left",[n.TREERIGHT]:"tree-right",[n.TREELEFT]:"tree-left",[n.ORGCHARTDOWN]:"org-down",[n.ORGCHARTUP]:"org-up",[n.FISHBONELEFTHEADED]:"fishbone-left",[n.FISHBONERIGHTHEADED]:"fishbone-right",[n.TIMELINEHORIZONTAL]:"timeline-horizontal",[n.TIMELINEVERTICAL]:"timeline-vertical",[n.TIMELINETHROUGHVERTICAL]:"timeline-through-vertical",[n.TIMELINESIDEDHORIZONTAL]:"timeline-sided-horizontal",[n.SPREADSHEET]:"matrix-row",[n.COLUMNSPREADSHEET]:"matrix-column",[n.TOPTITLETREETABLE]:"tree-table-column",[n.TREETABLE]:"tree-table-row"}},84374:(e,t,i)=>{"use strict";i.d(t,{CX:()=>m.CX,HG:()=>m.HG,KR:()=>m.KR,OE:()=>m.OE,QS:()=>m.QS,ZQ:()=>m.ZQ,aX:()=>m.aX,h0:()=>m.h0,nZ:()=>m.nZ,o9:()=>m.o9,pk:()=>m.pk,viewerKit:()=>m.q_});var n=i(3112),o=i(71017),r=i.n(o),l=i(72298),s=i(94593),a=i(13893),d=i.n(a),u=i(7104),c=i(5893),h=i(90435),p=i(54856),v=i(78152),f=i(63111),m=i(18653),g=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function s(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};const{getGlobalConfig:C,globalConfigSetup:F}=n.i;function w(e){return g(this,void 0,void 0,(function*(){return!(yield h.ZP.fetch(p.Gy,e))}))}!function(){const e={translatesCtrlClickAsContextMenu:!1,translatesCtrlEnterAsInsertingLineBreak:!0},t=(0,c.u3)(r().join((0,u.bY)(),"/static/snowbird/resource/"));n.i.globalConfigSetup({platformMapper:t=>e[t],guidedPayment:w,featureIsCurrentlyRestricted:e=>(0,v.Yh)().status!==f.wi.VALID&&!f.nd&&(h.ZP.fetch(p.Fx,{name:"dialog-activate",query:{innerFeatureName:e}}),!0),assetsBaseURL:t,clipboard:{read:()=>g(this,void 0,void 0,(function*(){const e=yield l.clipboard.readText("clipboard"),t=yield l.clipboard.readHTML("clipboard"),i=yield function(){return g(this,void 0,void 0,(function*(){let e=[];if(l.clipboard.has("CF_HDROP")){const t=l.clipboard.readBuffer("CF_HDROP").toString("ucs2")||"";let i=[...t].filter(((e,i)=>0!==t.charCodeAt(i))).join("").replace(/\\/g,"\\");const n=i.match(/[a-zA-Z]:\\/);if(n){const t=i.indexOf(n[0]);0!==t&&(i=i.substring(t)),e=i.split(n[0]).filter((e=>e)).map((e=>n+e))}}else e=[l.clipboard.readBuffer("FileNameW").toString("ucs2").replace(RegExp(String.fromCharCode(0),"g"),"")].filter((e=>e));const t=[];for(const i of e){const e=r().basename(i),n=d().getType(r().extname(i).substring(1));try{const o=yield s.Z.readFile(i);t.push(new File([new Blob([o.buffer],{type:n})],e,{type:n}))}catch(e){}}if(0===t.length){const e=l.clipboard.readImage();e.isEmpty()||t.push(new File([new Blob([e.toPNG().buffer],{type:"image/png"})],"Untitled.png",{type:"image/png"}))}return t}))}();return i.some((e=>!e.type.startsWith("image")))&&(yield w("insertAttachment"))?{text:null,html:null}:{text:e,html:t,files:i}})),write:e=>g(this,void 0,void 0,(function*(){var t;const i=yield null===(t=e.image)||void 0===t?void 0:t.arrayBuffer(),n=i?l.nativeImage.createFromBuffer(Buffer.from(i)):null;return l.clipboard.write({text:e.text,html:e.html,image:n},"clipboard")}))}})}()},3236:(e,t,i)=>{"use strict";i.d(t,{yh:()=>a,dM:()=>f,I6:()=>v,zF:()=>p,Y$:()=>r.Y});var n=i(1403),o=i(78598),r=i(12645);class l{constructor(){this.eventCallbacks=new Map}on(e,t){var i;const n=null!==(i=this.eventCallbacks.get(e))&&void 0!==i?i:[];this.eventCallbacks.set(e,[...n,t])}off(e,t){var i;let n=null!==(i=this.eventCallbacks.get(e))&&void 0!==i?i:[];n=n.filter((e=>e!==t)),this.eventCallbacks.set(e,n)}emit(e){const t=this.eventCallbacks.get(e.eventName);if(t)for(const i of t)i(e)}unload(){this.eventCallbacks=new Map}}var s=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function s(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};class a extends l{constructor(e){var t;super(),this._presenters=[],this._isStarted=!1,this._disableSettingsUpdate=!1,this._traveledTopicSet=new Set,this._needSubscriptionHint=!1,this.slideControl=e=>s(this,void 0,void 0,(function*(){const{action:t,value:i}=e;switch(t){case"goto":return yield this.slideshow.present(i);case"next":return yield this.slideshow.forward();case"prev":return yield this.slideshow.backward();case"fastBackward":return yield this.slideshow.fastBackward();case"fastForward":return yield this.slideshow.fastForward();case"updateSlide":return yield this.slideshow.forceUpdateSlideContent()}})),this.changeSlideSetting=e=>{const{action:t,option:i}=e;switch(t){case"theme":return this.changeTheme(i);case"aspect":return this.changeSlideAspect(i);case"animation":return this.switchAnimationOption(i);case"watermark":return this.switchWatermarkOption(i)}},this.unloaded=!1,this.settings=(0,r.Y)(),this._startTopicId=null!==(t=e.startTopicId)&&void 0!==t?t:null,this._suggestedSlideSize=e.suggestedSlideSize,this._disableSettingsUpdate=e.disableSettingsUpdate,this._needSubscriptionHint=!!e.needSubscriptionHint,this.initSlideshow(e)}get presenters(){return this._presenters}get slideshow(){return this._slideshow}get isShowingEnding(){return this._slideshow.isShowingEndingScreen}get currentSlide(){return this.slideshow.currentSlide}initSlideshow(e){var t,i,r,l;const s=e.contentProviderData?(0,o.xm)(e.contentProviderData):(0,o.n2)(),a=null!==(t=e.defaultAspect)&&void 0!==t?t:this.settings.slideAspect.value,d="Auto"===a?null!==(r=null===(i=e.suggestedSlideSize)||void 0===i?void 0:i.value)&&void 0!==r?r:"16:9":a;this._slideshow=new n.ur({contentProvider:s,slideTheme:null!==(l=e.defaultSlideTheme)&&void 0!==l?l:this.settings.slideTheme.value,slideSize:d,disablesWatermark:!this.settings.watermarkEnabled.value,preferredLanguage:this.settings.preferredLanguage.value}),this._slideshow.disablesAnimations=!this.settings.animationEnabled.value,this._slideshow.on("finish",(()=>this.finish())),this._slideshow.on("stateDidChange",(()=>{this.presenters.forEach((e=>e.stateChangedHandler()))})),this._slideshow.on("transitionStart",(({request:e})=>{const t=this._slideshow.computeNextStoppedSlide(e);t&&t.topicId&&(this._traveledTopicSet.add(t.topicId),this._needSubscriptionHint&&this._traveledTopicSet.size>5&&this.emit({eventName:"needSubscription"})),this.emit({eventName:"slideChangeStart",payload:{request:e,targetSlide:t}})})),this._slideshow.on("transitionEnd",(()=>this.emit({eventName:"slideChangeEnd"}))),this._slideshow.on("modalOpened",(()=>this.emit({eventName:"presenterModal",payload:{show:!0}}))),this._slideshow.on("modalClosed",(()=>this.emit({eventName:"presenterModal",payload:{show:!1}}))),this._slideshow.on("reveal",(({request:e})=>this.emit({eventName:"presenterLinkClick",payload:{title:e.title,href:e.href,topicId:e.topicId}}))),this._slideshow.on("playWebVideo",(({request:e})=>{this.emit({eventName:"playWebVideo",payload:{videoSource:e.videoSource}})}))}addPresenter(e){this._presenters.includes(e)||(this._presenters.push(e),this.slideshow.addPresenter(e.view))}removePresenter(e){this._presenters=this._presenters.filter((t=>t!==e)),this.slideshow.removePresenter(e.view)}switchAnimationOption(e){var t;this.slideshow.disablesAnimations=!e,!this._disableSettingsUpdate&&(null===(t=this.settings)||void 0===t||t.updateAnimationSetting(e))}switchWatermarkOption(e){var t;this.slideshow.disablesWatermark!==!e&&(this.slideshow.changeWatermarkDisabled(!e),!this._disableSettingsUpdate&&(null===(t=this.settings)||void 0===t||t.updateWatermarkSetting(e)))}changeTheme(e){var t;this.slideshow.slideAppearanceId!==e&&(this.slideshow.changeSlideTheme(e),!this._disableSettingsUpdate&&(null===(t=this.settings)||void 0===t||t.updateSlideThemeSetting(e)))}changeSlideAspect(e){var t,i,o;const r="Auto"===e?null!==(i=null===(t=this._suggestedSlideSize)||void 0===t?void 0:t.value)&&void 0!==i?i:"16:9":e;this.slideshow.changeSlideSize(n.IE[r]),!this._disableSettingsUpdate&&(null===(o=this.settings)||void 0===o||o.updateSlideAspectSetting(e))}start(e){return s(this,void 0,void 0,(function*(){this._isStarted||(e.forEach((e=>this.addPresenter(e))),this.slideshow.present(this._startTopicId),this._isStarted=!0)}))}finish(){this.emit({eventName:"slidePlayFinished"})}unload(){this.emit({eventName:"beforeUnload"}),super.unload(),this.unloaded=!0}}var d=i(90435),u=i(96829),c=i(54856),h=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function s(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};function p(){const e=(0,u.hb)(),t=d.ZP.route(c.OV.CONNECT_MAIN(e),(e=>h(this,void 0,void 0,(function*(){switch(e.type){case"retrieveContent":return JSON.stringify(yield(0,o.d4)());case"dismiss":return t();case"openHyperlink":return null}}))));return e}function v(e){return h(this,void 0,void 0,(function*(){const t=yield d.ZP.fetch(c.OV.CONNECT_MAIN(e),{type:"retrieveContent"});return JSON.parse(t)}))}function f(e){d.ZP.fetch(c.OV.CONNECT_MAIN(e),{type:"dismiss"})}},12645:(e,t,i)=>{"use strict";i.d(t,{Y:()=>d});var n=i(2954),o=i(78152),r=i(84374),l=i(78598);function s(e){var t,i;return null!==(i=null===(t=(0,l.pP)(e))||void 0===t?void 0:t["slide-appearance"])&&void 0!==i?i:"default"}function a(e){var t,i;return null!==(i=null===(t=(0,l.pP)(e))||void 0===t?void 0:t["slide-aspect-ratio"])&&void 0!==i?i:"Auto"}const d=function(){const{activeSheet:e}=(0,r.nZ)(),t=(0,n.Fl)((()=>{var t;return null===(t=e.value)||void 0===t?void 0:t.rootTopic.id})),i=(0,n.Fl)((()=>!(0,o.rs)().disableAnimation)),d=(0,n.Fl)((()=>!(0,o.Yh)().isStatusValid||(0,o.rs)().watermarkEnabled)),u=(0,n.iH)(a(t.value)),c=(0,n.iH)(s(t.value)),h=(0,n.Fl)((()=>"zh-CN"===(0,o.S)().language||"zh-CN"===(0,o.S)().defaultLanguage?"zh":"en")),p=e=>{(0,o.rs)().updateSettings({disableAnimation:!e})},v=e=>{(0,o.rs)().updateSettings({watermarkEnabled:e})},f=e=>{e!==s(t.value)&&((0,l.nh)(t.value,{"slide-appearance":e}),c.value=e)},m=e=>{e!==a(t.value)&&((0,l.nh)(t.value,{"slide-aspect-ratio":e}),u.value=e)};return(0,n.YP)((()=>t.value),(e=>{u.value=a(e),c.value=s(e)})),()=>({animationEnabled:i,watermarkEnabled:d,slideTheme:(0,n.Fl)((()=>c.value)),slideAspect:(0,n.Fl)((()=>u.value)),preferredLanguage:h,updateAnimationSetting:p,updateWatermarkSetting:v,updateSlideThemeSetting:f,updateSlideAspectSetting:m})}()},1403:(e,t,i)=>{"use strict";i.d(t,{CU:()=>s,YN:()=>a,ur:()=>n.Slideshow,I2:()=>n.SlideshowExporter,rc:()=>v,qV:()=>p,WS:()=>h,bh:()=>u,sz:()=>d,_y:()=>c,_p:()=>n.previewSlidesScopedBy,IE:()=>n.slideSizes,hf:()=>f,tT:()=>l});var n=i(32118),o=i(78598);const r={summarySlideVisibility:"summary-slide-visibility",topicSlideVisibility:"topic-slide-visibility",topicImagePlacement:"topic-slide-image-placement",listSlideVisibility:"list-slide-visibility",listSlideDelivery:"list-slide-delivery",listSlideLayout:"list-slide-layout"};function l(){const e=(e,t,i)=>(0,o.nh)(e,{[r[t]]:i});return{getSlideOption:(e,t)=>{var i;return null===(i=(0,o.pP)(e))||void 0===i?void 0:i[r[t]]},setSlideOption:e,deleteSlideOption:(t,i)=>e(t,i)}}const s="org.xmind.ui.ice-cream-pancake",a=["Auto","16:9","4:3","9:16","3:4"];function d(e){return new n.Slideshow(e)}function u(e={}){const{initialSlide:t,perspectiveMode:i,viewStyle:o,contentStyle:r}=e,l=new n.PresentationView({initialSlide:t});return i?(l.allowsActivatingPresenterPerspectiveMode=!0,l.mode="presenterPerspective"):(l.allowsActivatingPresenterPerspectiveMode=!1,l.mode="presentation"),o&&Object.keys(o).forEach((e=>l.el.style[e]=o[e])),r&&Object.keys(r).forEach((e=>l.contentEl.style[e]=r[e])),l}function c(e,t,i){return{topicSkipped:(0,n.isSlideSkippedScopedBy)(e,t,"topic",{ignoresUserValue:i}),listSkipped:(0,n.isSlideSkippedScopedBy)(e,t,"list",{ignoresUserValue:i}),summarySkipped:(0,n.isSlideSkippedScopedBy)(e,t,"summary",{ignoresUserValue:i})}}function h(e,t){const i=(0,n.computeSlideContent)(t,e.contentProvider,e.defaultListSlideDelivery);return i&&i.topic.image?(0,n.computeTopicSlideImagePlacement)(e.slideSize,i,i.topic.image,{ignoresUserValue:!0}):null}function p(e,t){return(0,n.computeSlideLayout)("list",e.slideSize,e.getSlideContent(t))}function v(e,t){return(0,n.getEligibleSlideLayouts)("list",e.getSlideContent(t))}function f(e,t){const i=e.getSlideContent(t.topicId).computedListSlideDelivery;let n=[];if("list"===t.type&&"all-at-once"===i&&(n=[...n,...t.subtopics||[]]),t.boxes){const e=i=>{for(const o of i){if((o.id.startsWith("topic:title:")||o.id.startsWith("topic:image:"))&&o.opacity){const e=o.id.split(":")[2];t.subtopics.includes(e)&&n.push(o.id.split(":")[2])}"children"in o&&e(o.children)}};e(t.boxes)}const o=t.topicId,r=[...new Set(n)].filter((e=>e!==o));return{topicId:o,subTopicIds:r}}},45133:(e,t,i)=>{"use strict";i.d(t,{yh:()=>n.yh,Nn:()=>m,c4:()=>g,XT:()=>F.XT,iA:()=>F.iA,vN:()=>C,dM:()=>n.dM,HZ:()=>E,Su:()=>T,I6:()=>n.I6,zF:()=>n.zF,Y$:()=>n.Y$,_x:()=>F._x});var n=i(3236),o=i(90435),r=i(2954),l=i(1403),s=i(54856),a=i(86633),d=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function s(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};const u=(0,a.ZP)("pitchmode");class c{sendMessage(e,t){return d(this,void 0,void 0,(function*(){try{return yield o.ZP.fetch(s.OV.SUB_COMMAND(this.proxyId),{command:e,payload:t})}catch(e){return u.warn("SendMessage: ",e),e}}))}performTransition(e){return d(this,void 0,void 0,(function*(){yield this.sendMessage("performTransition",e)}))}performStateChange(e,t){return d(this,void 0,void 0,(function*(){yield this.sendMessage("performStateChange",{state:e,animationOptions:t})}))}preloadTransition(e){this.sendMessage("preloadTransition",e)}presentEndingScreen(e,t,i,n,o){return d(this,void 0,void 0,(function*(){this.sendMessage("presentEndingscreen",{content:e,slideSize:t,epilogueSlide:i,backgroundColor:n,options:o})}))}dismissEndingScreen(e){return d(this,void 0,void 0,(function*(){this.sendMessage("dismissEndingscreen",e)}))}presentModalDisplay(e,t){return d(this,void 0,void 0,(function*(){this.sendMessage("presentModalDisplay",{options:e,boxId:t})}))}dismissModalDisplay(e){return d(this,void 0,void 0,(function*(){this.sendMessage("dismissModalDisplay",{contentType:e})}))}constructor(e){this.proxyId=e}unload(){}}var h=i(96829),p=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function s(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};class v{constructor(){this.ready=(0,r.iH)(!1),this.isProxiedPresenter=!1,this._id=(0,h.hb)()}get id(){return this._id}get isReady(){return this.ready.value}setReady(){this.ready.value=!0}init(){return p(this,void 0,void 0,(function*(){}))}stateChangedHandler(){}unload(){}}var f=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function s(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};class m extends v{constructor(e){var t;super(),this._containerEle=null,this.presentationViewOptions=e.presentationViewOptions,this.isShowingPerspective=(0,r.iH)(!1),this.isEnablePerspective=!!(null===(t=e.presentationViewOptions)||void 0===t?void 0:t.perspectiveMode)}get view(){return this._presentationView}get container(){return this._containerEle}get viewEle(){return this._presentationView.el}init(){return f(this,void 0,void 0,(function*(){this.createPresentationView(this.presentationViewOptions),this.setReady()}))}createPresentationView(e){this._presentationView=(0,l.bh)({initialSlide:e.initialSlide,perspectiveMode:e.perspectiveMode,viewStyle:{left:"0",right:"0",width:"100%",height:"100%",backgroundColor:"#000000"},contentStyle:{backgroundColor:"#000000"}})}update(){this._presentationView.update()}connect(){this._presentationView.connect()}stateChangedHandler(){this.isEnablePerspective&&(this.isShowingPerspective.value="presenterPerspective"===this.view.mode)}setContainer(e){this._containerEle||(this._containerEle=e,this._containerEle.appendChild(this.viewEle),this.update(),this.connect())}unload(){var e;null===(e=this._containerEle)||void 0===e||e.removeChild(this.viewEle),this._containerEle=null}}class g extends v{constructor(e){super(),this.isProxy=!0,this._unRoute=[],this.presentationViewOptions=e.presentationViewOptions}get view(){return this._proxyView}init(){return f(this,void 0,void 0,(function*(){return this.createPresentationProxyView(this.id),yield this.connectProxiedPresenter()}))}createPresentationProxyView(e){this._proxyView=new c(e)}connectProxiedPresenter(){const e=window.id;return this._unRoute.push(o.ZP.route(s.OV.CONNECT_MAIN(e),(()=>(setTimeout((()=>{this.setReady()}),50),{presentationViewOptions:this.presentationViewOptions,proxyId:this.id})))),new Promise((e=>{const t=(0,r.YP)((()=>this.ready.value),(i=>{i&&(e(),t())}))}))}unload(){this._unRoute.forEach((e=>e()))}}class C extends m{constructor(e){super({}),this.isProxiedPresenter=!0,this.remoteWindowId=e}init(){return f(this,void 0,void 0,(function*(){yield this.connectProxy(),this.setReady()}))}connectProxy(){return f(this,void 0,void 0,(function*(){const e=()=>f(this,void 0,void 0,(function*(){return(yield Promise.race([o.ZP.fetch(s.OV.CONNECT_MAIN(this.remoteWindowId)),new Promise((e=>setTimeout(e,1e3)))]))||(yield e())})),t=yield e();var i,n;this.createPresentationView(t.presentationViewOptions),i=this._presentationView,n=t.proxyId,o.ZP.route(s.OV.SUB_COMMAND(n),(e=>{switch(e.command){case"performTransition":return i.performTransition(e.payload);case"performStateChange":return i.performStateChange(e.payload.state,e.payload.animationOptions);case"preloadTransition":return i.preloadTransition(e.payload);case"presentEndingscreen":return i.presentEndingScreen(e.payload.content,e.payload.slideSize,e.payload.epilogueSlide,e.payload.backgroundColor,e.payload.options);case"dismissEndingscreen":return i.dismissEndingScreen(e.payload);case"presentModalDisplay":return i.presentModalDisplay(e.payload.options,e.payload.boxId);case"dismissModalDisplay":return i.dismissModalDisplay(e.payload.contentType)}}))}))}}var F=i(58510),w=i(53775),S=i(12645);function E(e,t){const i=t=>{(function(e,t){const i=(0,w.Ds)(e.slideControl,100),{animationEnabled:n}=(0,S.Y)();switch(t.key){case"PageDown":case"ArrowDown":case"Enter":case" ":return i({action:"next"}),!0;case"ArrowRight":return t.shiftKey?i({action:"fastForward"}):i({action:"next"}),!0;case"PageUp":case"ArrowUp":return i({action:"prev"}),!0;case"ArrowLeft":return t.shiftKey?i({action:"fastBackward"}):i({action:"prev"}),!0;case"Escape":case"q":case"Q":return e.finish(),!0;case"a":case"A":return e.switchAnimationOption(!n.value),!0}return!1})(e,t)&&(t.preventDefault(),t.stopPropagation())};return t.addEventListener("keydown",i),e.on("beforeUnload",(()=>{t.removeEventListener("keydown",i)})),e}var y=i(78152);function T(e,t){return e.on("playWebVideo",(({payload:e})=>{var i,n,o;const r=null!==(n=null===(i=null==t?void 0:t.subWindow)||void 0===i?void 0:i.getBounds())&&void 0!==n?n:null===(o=null==t?void 0:t.mainWindow)||void 0===o?void 0:o.getBounds(),l=r?Object.assign(Object.assign({},r),{fullscreen:!0}):null;!function(e){const{handleCommand:t}=(0,y.JX)(),{videoSource:i,overrideSetting:n}=e;i&&t("videoViewer",{url:i,overrideSetting:n})}({videoSource:e.videoSource,overrideSetting:l})})),e}},78598:(e,t,i)=>{"use strict";i.d(t,{xm:()=>v,pP:()=>f,n2:()=>h,d4:()=>p,nh:()=>m});var n=i(2954),o=i(1403),r=i(40623),l=i(84374);const{TopicQuickStyleClassName:s,PrimaryClassName:a,TopicPrimaryClassName:d}=l.viewerKit,u=Object.freeze({default:{[a.Map]:{fillColor:"#101010",multiLineColors:["#F6F6F6"].join(" ")},[a.Relationship]:{lineColor:"#F6F6F6",textColor:"#FFFFFF"},[a.Boundary]:{fillColor:"#F6F6F6",textColor:"#000000"},[a.Summary]:{},[d.CentralTopic]:{fillColor:"#F6F6F6",textColor:"#000000"},[d.MainTopic]:{fillColor:"#E3E3E3",textColor:"#000000"},[d.Subtopic]:{fillColor:"#B9B9B9",textColor:"#000000"},[d.FloatingTopic]:{fillColor:"#BABABA",textColor:"#000000"},[d.CalloutTopic]:{fillColor:"#F6F6F6",textColor:"#000000"},[d.SummaryTopic]:{fillColor:"#F6F6F6",textColor:"#000000"},[s.VeryImportant]:{fillColor:"#A43838"},[s.Important]:{fillColor:"#CFA362",textColor:"#000000"},[s.CrossOut]:{}},light:{[a.Map]:{fillColor:"#F4F4F4",multiLineColors:["#282828"].join(" ")},[a.Relationship]:{lineColor:"#282828",textColor:"#000000"},[a.Boundary]:{fillColor:"#282828",textColor:"#FFFFFF"},[a.Summary]:{},[d.CentralTopic]:{fillColor:"#282828",textColor:"#FFFFFF"},[d.MainTopic]:{fillColor:"#282828",textColor:"#FFFFFF"},[d.Subtopic]:{fillColor:"#4F4F4F",textColor:"#FFFFFF"},[d.FloatingTopic]:{fillColor:"#4F4F4F",textColor:"#FFFFFF"},[d.CalloutTopic]:{fillColor:"#282828",textColor:"#FFFFFF"},[d.SummaryTopic]:{fillColor:"#282828",textColor:"#FFFFFF"},[s.VeryImportant]:{fillColor:"#A43838"},[s.Important]:{fillColor:"#CFA362",textColor:"#000000"},[s.CrossOut]:{}},Innocence:{[a.Map]:{fillColor:"#ECF4E9",multiLineColors:["#FF9A9A","#F9E168","#FFC368","#ACDB87","#749AC7","#FF9A9A"].join(" ")},[a.Relationship]:{lineColor:"#F06767",textColor:"#F7FFF4"},[a.Boundary]:{fillColor:"#F06767",textColor:"#F7FFF4"},[a.Summary]:{},[d.CentralTopic]:{fillColor:"#F06767"},[d.MainTopic]:{textColor:"#000000"},[d.Subtopic]:{textColor:"#000000"},[d.FloatingTopic]:{fillColor:"#797979",textColor:"#F7FFF4"},[d.CalloutTopic]:{fillColor:"#F06767",textColor:"#F7FFF4"},[d.SummaryTopic]:{fillColor:"#F06767",textColor:"#000000"},[s.VeryImportant]:{fillColor:"#1000C6"},[s.Important]:{fillColor:"#22D896",textColor:"#000000"},[s.CrossOut]:{}},"Hubble-Bubble":{[a.Map]:{fillColor:"#1D663A",multiLineColors:"#A2B864"},[a.Relationship]:{lineColor:"#A2B864",textColor:"#FEFFD0"},[a.Boundary]:{fillColor:"#A2B864",textColor:"#FFFFFF"},[a.Summary]:{},[d.CentralTopic]:{fillColor:"#39B169",textColor:"#FEFFD0"},[d.MainTopic]:{fillColor:"#39B169",textColor:"#FEFFD0"},[d.Subtopic]:{fillColor:"#2E9356",textColor:"#FEFFD0"},[d.FloatingTopic]:{fillColor:"#A2B864",textColor:"#1D663A"},[d.CalloutTopic]:{fillColor:"#FEFFD0",textColor:"#000000"},[d.SummaryTopic]:{fillColor:"#A2B864",textColor:"#1D663A"},[s.VeryImportant]:{fillColor:"#FA813D",textColor:"#000000"},[s.Important]:{fillColor:"#ECDE5D",textColor:"#000000"},[s.CrossOut]:{}},"midnight-rose":{[a.Map]:{fillColor:"#010518",multiLineColors:"#9EAEFF"},[a.Relationship]:{lineColor:"#2C47D8",textColor:"#FFFFFF"},[a.Boundary]:{fillColor:"#2C47D8",textColor:"#FFFFFF"},[a.Summary]:{},[d.CentralTopic]:{fillColor:"#2C47D8",textColor:"#FFFFFF"},[d.MainTopic]:{fillColor:"#2C47D8",textColor:"#FFFFFF"},[d.Subtopic]:{fillColor:"#3E4C95",textColor:"#FFFFFF"},[d.FloatingTopic]:{fillColor:"#DEE3FF",textColor:"#404E9C"},[d.CalloutTopic]:{fillColor:"#FEFFD0",textColor:"#404E9C"},[d.SummaryTopic]:{fillColor:"#9EAEFF",textColor:"#404E9C"},[s.VeryImportant]:{fillColor:"#A716CB",textColor:"#000000"},[s.Important]:{fillColor:"#D45757",textColor:"#000000"},[s.CrossOut]:{}},"shape-for-you":{[a.Map]:{fillColor:"#F5D8DD",multiLineColors:["#EDB998","#BEADA6","#E994B1","#ACBCD6","#B1ABD6","#B0CD99","#97D6C3","#BDB783"].join(" ")},[a.Relationship]:{lineColor:"#E59294",textColor:"#000000"},[a.Boundary]:{fillColor:"#E59294",textColor:"#FFFFFF"},[a.Summary]:{},[d.CentralTopic]:{fillColor:"#E59294",textColor:"#000000"},[d.MainTopic]:{fillColor:"#E59294",textColor:"#000000"},[d.Subtopic]:{fillColor:"#E59294",textColor:"#000000"},[d.FloatingTopic]:{fillColor:"#4B4B4B",textColor:"#FFFFFF"},[d.CalloutTopic]:{fillColor:"#E59294",textColor:"#000000"},[d.SummaryTopic]:{fillColor:"#E59294",textColor:"#000000"},[s.VeryImportant]:{fillColor:"#50209E",textColor:"#000000"},[s.Important]:{fillColor:"#D45757",textColor:"#62A8CF"},[s.CrossOut]:{}},"hand-drawn":{[a.Map]:{fillColor:"#DCE2D4",multiLineColors:"#2F4DB5"},[a.Relationship]:{lineColor:"#2F4DB5",textColor:"#2F4DB5"},[a.Boundary]:{fillColor:"#2F4DB5",textColor:"#FFFFFF"},[a.Summary]:{},[d.CentralTopic]:{fillColor:"#2F4DB5",textColor:"#FFFFFF"},[d.MainTopic]:{fillColor:"#2F4DB5",textColor:"#FFFFFF"},[d.Subtopic]:{fillColor:"#5E6AA2",textColor:"#FFFFFF"},[d.FloatingTopic]:{fillColor:"#5A5E74",textColor:"#EDF4E5"},[d.CalloutTopic]:{fillColor:"#2F4DB5",textColor:"#FFFFFF"},[d.SummaryTopic]:{fillColor:"#2F4DB5",textColor:"#FFFFFF"},[s.VeryImportant]:{fillColor:"#9433AC",textColor:"#FFFFFF"},[s.Important]:{fillColor:"#D05252",textColor:"#FFFFFF"},[s.CrossOut]:{}}});var c=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function s(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};function h(e){const{sheets:t,activeSheetId:i,getSheetViewer:o}=(0,l.nZ)(),r=(0,n.Fl)((()=>t.value.find((t=>t.id===(null!=e?e:i.value))))),s=(0,n.Fl)((()=>o(r.value.id)));return{getStartingTopicId:()=>{var e,t,i;return null!==(i=null===(t=null===(e=r.value)||void 0===e?void 0:e.rootTopic)||void 0===t?void 0:t.id)&&void 0!==i?i:null},getTopicAttributes:e=>{var t,i,n,o,l,a,d,u,c,h,p;const v=null===(i=null===(t=r.value)||void 0===t?void 0:t.query({id:e}))||void 0===i?void 0:i.asTopic(),m=null===(o=null===(n=s.value)||void 0===n?void 0:n.getSheetFigure())||void 0===o?void 0:o.topicFigureByTopicId[e],E=f(e);return v&&{id:null==v?void 0:v.id,title:null!==(l=null==v?void 0:v.title)&&void 0!==l?l:"",labels:null!==(a=null==v?void 0:v.labels)&&void 0!==a?a:[],note:(null==v?void 0:v.notes)&&{plainText:null===(d=v.notes)||void 0===d?void 0:d.text,html:null===(u=v.notes)||void 0===u?void 0:u.html},image:C(m),summaries:null===(c=null==v?void 0:v.summaries)||void 0===c?void 0:c.map((e=>({topicId:e.id,startIndex:e.rangeStart,endIndex:e.rangeEnd}))),markers:g(null!==(h=null==v?void 0:v.markers)&&void 0!==h?h:[]),video:F(m),calloutTopicId:null===(p=null==v?void 0:v.callout)||void 0===p?void 0:p.id,hyperlink:w(v),topicSlide:null==E?void 0:E["topic-slide-visibility"],topicSlideImagePlacement:null==E?void 0:E["topic-slide-image-placement"],listSlides:null==E?void 0:E["list-slide-visibility"],listSlideLayout:null==E?void 0:E["list-slide-layout"],listSlideDelivery:null==E?void 0:E["list-slide-delivery"],summarySlide:null==E?void 0:E["summary-slide-visibility"],preferredDefaultListSlideLayout:S(m)}},getSubtopics:e=>{var t,i,n,o;const l=null===(i=null===(t=r.value)||void 0===t?void 0:t.query({id:e}))||void 0===i?void 0:i.asTopic();return null!==(o=null===(n=null==l?void 0:l.children)||void 0===n?void 0:n.map((e=>e.id)))&&void 0!==o?o:[]},getParentTopicId:e=>{var t,i,n,o;const l=null===(i=null===(t=r.value)||void 0===t?void 0:t.query({id:e}))||void 0===i?void 0:i.asTopic();return null!==(o=null===(n=null==l?void 0:l.parentTopic)||void 0===n?void 0:n.id)&&void 0!==o?o:null},getFloatingTopics:()=>{var e,t,i;return null!==(i=null===(t=null===(e=r.value)||void 0===e?void 0:e.rootTopic)||void 0===t?void 0:t.detachedChildren.map((e=>e.id)))&&void 0!==i?i:[]},getEndingScreenContent:e=>c(this,void 0,void 0,(function*(){var t,i,n,o,l,a,d,c;const h=null!==(l=null!==(t=null==e?void 0:e.appearance)&&void 0!==t?t:null===(o=f(null===(n=null===(i=r.value)||void 0===i?void 0:i.rootTopic)||void 0===n?void 0:n.id))||void 0===o?void 0:o["slide-appearance"])&&void 0!==l?l:"default",{svg:p,size:v}=yield s.value.exportSVGElementWithSizeUsingSheetAppearance(r.value,null!==(a=u[h])&&void 0!==a?a:u.default,{padding:{left:20,right:20,top:20,bottom:20},disableEmbedFonts:!0});return{svgString:(new XMLSerializer).serializeToString(p),width:null!==(d=v.width)&&void 0!==d?d:parseInt(p.getAttribute("width")),height:null!==(c=v.height)&&void 0!==c?c:parseInt(p.getAttribute("height"))}}))}}function p(){return c(this,void 0,void 0,(function*(){const e=h(),t=e.getStartingTopicId(),i=e.getFloatingTopics(),n=[t,...i],o=t=>{const i=t.map((t=>e.getSubtopics(t))).flat();n.push(...i),i.length<=0||o(i)};o(n);const r={},l={},s={};n.forEach((t=>{r[t]=e.getTopicAttributes(t),l[t]=e.getParentTopicId(t),s[t]=e.getSubtopics(t)}));const a=yield e.getEndingScreenContent(void 0);return{startingTopicId:t,floatingTopicIds:i,topicRecords:r,parentRecords:l,subTopicsRecords:s,endingScreenContent:a}}))}function v(e){const{startingTopicId:t,floatingTopicIds:i,topicRecords:n,subTopicsRecords:o,parentRecords:r,endingScreenContent:l}=e;return{getStartingTopicId:()=>t,getTopicAttributes:e=>{var t;return null!==(t=n[e])&&void 0!==t?t:null},getSubtopics:e=>{var t;return null!==(t=o[e])&&void 0!==t?t:[]},getParentTopicId:e=>{var t;return null!==(t=r[e])&&void 0!==t?t:null},getFloatingTopics:()=>i,getEndingScreenContent:()=>c(this,void 0,void 0,(function*(){return l}))}}function f(e){var t,i,n;const{document:r}=(0,l.nZ)(),s=null===(i=null===(t=r.value)||void 0===t?void 0:t.query({id:e}))||void 0===i?void 0:i.asTopic(),a=null==s?void 0:s.extensionBy(o.CU);return null!==(n=null==a?void 0:a.content)&&void 0!==n?n:null}function m(e,t){var i,n,r,s,a;const{document:d,changeDoc:u}=(0,l.nZ)(),c=null===(n=null===(i=d.value)||void 0===i?void 0:i.query({id:e}))||void 0===n?void 0:n.asTopic(),h=null!==(s=null===(r=null==c?void 0:c.extensionBy(o.CU))||void 0===r?void 0:r.content)&&void 0!==s?s:{},p={content:Object.assign(Object.assign({},h),t)},v=null===(a=null==c?void 0:c.asMutable())||void 0===a?void 0:a.extensionBy(o.CU,p).commit().ownerDocument;v&&u(v)}function g(e){const{markerModule:t}=(0,l.nZ)();return e.map((e=>({markerId:e,imageSource:t.getMarkerInfoById(e).imageSrc}))).filter((e=>!!e.imageSource))}function C(e){var t,i,n,o,r;if(!e)return null;const{imageView:s,measuredImageView:a,imageNaturalSize:d}=e.nodeContent,u=null==e?void 0:e.modelAttributes,c=null===(t=null==u?void 0:u.equation)||void 0===t?void 0:t.text;if(c)return function(e){var t,i;const n=(null!==(t=(0,l.nZ)().makeMathJaxSVG(e))&&void 0!==t?t:"").replace(/currentColor/g,"");if(!n)return null;const o=null===(i=(new DOMParser).parseFromString(n,"image/svg+xml"))||void 0===i?void 0:i.documentElement;return o?{source:n,size:{width:parseInt(o.getAttribute("width")),height:parseInt(o.getAttribute("height"))}}:null}(c);{const e=null!==(n=null!==(i=null==d?void 0:d.width)&&void 0!==i?i:null==a?void 0:a.width)&&void 0!==n?n:null==u?void 0:u.imageWidth,t=null!==(r=null!==(o=null==d?void 0:d.height)&&void 0!==o?o:null==a?void 0:a.height)&&void 0!==r?r:null==u?void 0:u.imageHeight,l=null==s?void 0:s.src;return e&&t&&l?{source:l,size:{width:e,height:t}}:null}}function F(e){var t,i;const n=null===(i=null===(t=null==e?void 0:e.modelAttributes)||void 0===t?void 0:t.webVideo)||void 0===i?void 0:i.embedUrl;return n?{videoSource:n}:null}function w(e){const t=null==e?void 0:e.href;if(!t)return null;const i=t&&function(e){return e.toLowerCase().startsWith("xap:resources")?"attachment":e.toLowerCase().startsWith("file:")?"local":e.toLowerCase().startsWith("xmind:")?null:"webpage"}(t);return t&&i?{href:t,type:i}:null}function S(e){var t,i;const n=null!==(i=null===(t=null==e?void 0:e.modelAttributes)||void 0===t?void 0:t.structureClass)&&void 0!==i?i:null;return[r.v.FISHBONELEFTHEADED,r.v.FISHBONERIGHTHEADED].includes(n)?"fishbone":[r.v.TIMELINEHORIZONTAL,r.v.TIMELINESIDEDHORIZONTAL,r.v.TIMELINETHROUGHVERTICAL].includes(n)?"timeline":null}},58510:(e,t,i)=>{"use strict";i.d(t,{Ur:()=>v,XT:()=>c,_x:()=>p,iA:()=>h});var n=i(67657),o=i(90435),r=i(54856),l=i(82361),s=i(1403),a=i(53775),d=function(e,t,i,n){return new(i||(i=Promise))((function(o,r){function l(e){try{a(n.next(e))}catch(e){r(e)}}function s(e){try{a(n.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,s)}a((n=n.apply(e,t||[])).next())}))};const u=n.screen,c={AFTER_SUB_WINDOW_CREATED:"pitch:afterSubWindowCreated",AFTER_SUB_WINDOW_REMOVED:"pitch:afterSubWindowRemoved",ON_DISPLAY_ADDED:"pitch:onDisplayAdded",ON_DISPLAY_REMOVED:"pitch:onDisplayRemoved",ON_MAIN_WINDOW_ENTER_FULLSCREEN:"pitch:onMainWindowEnterFullScreen",ON_MAIN_WINDOW_LEAVE_FULLSCREEN:"pitch:onMainWindowLeaveFullScreen"};class h extends l.EventEmitter{constructor(){super(),this.mainWindowId=window.id,this.subWindowId=null,this.subWindowDisplayId=null,this.win=n.getCurrentWindow(),this._windowFittedSlideSize={},this.onDisplayAdded=()=>d(this,void 0,void 0,(function*(){yield new Promise((e=>setTimeout(e,1e3))),this.emit(c.ON_DISPLAY_ADDED)})),this.onDisplayRemoved=()=>{u.getAllDisplays().map((e=>e.id)).includes(this.subWindowDisplayId)||this.closeSubWindow(),this.emit(c.ON_DISPLAY_REMOVED)},this.onMainWindowEnterFullScreen=()=>{this.emit(c.ON_MAIN_WINDOW_ENTER_FULLSCREEN)},this.onMainWindowLeaveFullScreen=()=>{this.emit(c.ON_MAIN_WINDOW_LEAVE_FULLSCREEN)},u.on("display-added",this.onDisplayAdded),u.on("display-removed",this.onDisplayRemoved),this.win.on("enter-full-screen",this.onMainWindowEnterFullScreen),this.win.on("leave-full-screen",this.onMainWindowLeaveFullScreen)}get subWindowCreated(){return null!==this.subWindowId}get mainWindow(){return this.win}get subWindow(){var e;return this.subWindowId&&(null===(e=n.BrowserWindow)||void 0===e?void 0:e.fromId(this.subWindowId))}get windowFittedSlideSize(){var e,t,i;const n=null!==(i=null===(t=null===(e=this.subWindow)||void 0===e?void 0:e.getContentSize)||void 0===t?void 0:t.call(e))&&void 0!==i?i:this.win.getContentSize();return this._windowFittedSlideSize.value=v(n),this._windowFittedSlideSize}createSubWindow(){var e;return d(this,void 0,void 0,(function*(){if(this.subWindowCreated)return!1;const t=this.getSubWindowDisplay();if(!t)return!1;const i=yield o.ZP.fetch(r.Fx,{name:"presentation",query:{remoteId:this.mainWindowId},backgroundThrottling:!1,overrideSetting:{x:t.bounds.x,y:t.bounds.y,fullscreen:!0,focusable:!1,backgroundColor:"#000000"}});return this.subWindowDisplayId=t.id,this.subWindowId=i.id,null===(e=this.subWindow)||void 0===e||e.on("focus",(()=>this.focusMainWindow())),this.emit(c.AFTER_SUB_WINDOW_CREATED,this.subWindowId),!0}))}getSubWindowDisplay(){const e=u.getDisplayMatching(n.getCurrentWindow().getBounds());return u.getAllDisplays().filter((t=>t.id!==e.id))[0]||null}closeSubWindow(){var e;this.subWindowId&&(null===(e=this.subWindow)||void 0===e||e.close(),this.subWindowId=null,this.subWindowDisplayId=null,this.emit(c.AFTER_SUB_WINDOW_REMOVED))}enterFullscreen(e){return d(this,void 0,void 0,(function*(){return yield o.ZP.fetch(r.IB,{fullscreen:!0,editorViewId:window.editorId,targetElementId:e})}))}leaveFullscreen(e){return d(this,void 0,void 0,(function*(){return yield o.ZP.fetch(r.IB,{fullscreen:!1,editorViewId:window.editorId,targetElementId:e})}))}focusMainWindow(){var e;null===(e=this.win)||void 0===e||e.focus()}unload(){u.removeListener("display-added",this.onDisplayAdded),u.removeListener("display-removed",this.onDisplayRemoved),this.win.removeListener("enter-full-screen",this.onMainWindowEnterFullScreen),this.win.removeListener("leave-full-screen",this.onMainWindowLeaveFullScreen),this.closeSubWindow()}}function p(e){e||(e=n.getCurrentWindow());return{lockAspect:t=>{if(!t){const{width:i,height:n}=e.getBounds();t=i/n}e.setAspectRatio(t)},releaseAspect:()=>e.setAspectRatio(0),setMinimumSize:(t,i)=>e.setMinimumSize(t,i),setBounds:t=>e.setBounds(t),smoothOnResize:t=>{e.on("resize",(0,a.P2)((()=>window.requestAnimationFrame(t)),1e3/60))},closeWindow:()=>e.close(),onWindowClose:t=>e.on("close",t),computeSuitableWindowSize:f,computeSuitableSlideSizeIdFromWindowSize:v}}function v(e){e||(e=n.getCurrentWindow().getContentSize());const t=e[0]/e[1];let i="16:9",o=1/0;for(const e of Object.keys(s.IE)){if(!/\d+:\d+/.test(e))continue;const n=e.split(":").map((e=>Number(e))),r=Math.abs(n[0]/n[1]-t);r<o&&(o=r,i=e)}return i}function f(e){const t=g().bounds,i=e=>e.width+80<t.width&&e.height+80<t.height;let n=m(function(){const e=g();if(!e)return"16:9";const t=e.bounds,i=t.width/t.height;let n="16:9",o=1/0;for(const e of Object.keys(s.IE)){if(!/\d+:\d+/.test(e))continue;const t=e.split(":").map((e=>Number(e))),r=Math.abs(t[0]/t[1]-i);r<o&&(o=r,n=e)}return n}());const o={width:1280,height:Math.floor(1280/n),x:0,y:0,minWidth:360,minHeight:360};if("Auto"!==e&&(n=m(e),o.height=Math.floor(o.width/n),n<1?o.minHeight=Math.floor(o.minWidth/n):o.minWidth=Math.floor(o.minHeight*n)),!i(o))for(const e of[960,640,360])if(o.width=e,o.height=Math.floor(e/n),i(o))break;return o.x=Math.floor(t.x+(t.width-o.width)/2),o.y=Math.floor(t.y+(t.height-o.height)/2),o}function m(e){const t=e.split(":").map((e=>Number(e)));return t[0]/t[1]}function g(){const e=n.screen,t=n.getCurrentWindow().getBounds();return e.getDisplayMatching(t)}},52339:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n=i(2954);const o=(0,n.aZ)({__name:"pitch-container",props:{presenter:null,isShowingMask:{type:Boolean},fadeIn:{type:Boolean}},emits:["maskClicked"],setup(e,{emit:t}){const i=e,o=(0,n.iH)();return(0,n.bv)((()=>{var e;null===(e=i.presenter)||void 0===e||e.setContainer(o.value),i.fadeIn&&(o.value.style.opacity="0",setTimeout((()=>{o.value&&(o.value.style.opacity="1")}),300))})),{__sfc:!0,props:i,emit:t,presentationContainer:o}}});i(43488);const r=(0,i(51900).Z)(o,(function(){var e=this,t=e._self._c,i=e._self._setupProxy;return t("div",{ref:"presentationContainer",staticClass:"presentation-container"},[e.isShowingMask?t("div",{staticClass:"mask",on:{click:function(e){return i.emit("maskClicked")}}}):e._e()])}),[],!1,null,"54c5b1d2",null).exports},43488:(e,t,i)=>{var n=i(9342);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,i(45346).Z)("66079e86",n,!0,{})},79285:(e,t,i)=>{var n=i(48183);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,i(45346).Z)("3faa74d0",n,!0,{})},6113:e=>{"use strict";e.exports=require("crypto")},72298:e=>{"use strict";e.exports=require("electron")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},63477:e=>{"use strict";e.exports=require("querystring")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")}},e=>{e.O(0,[6486,2118,3112,172,2244],(()=>{return t=44799,e(e.s=t);var t}));var t=e.O();module.exports=t}]);