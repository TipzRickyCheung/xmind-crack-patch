(global.webpackChunkxmind_vana=global.webpackChunkxmind_vana||[]).push([[371],{27071:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>r});var n=o(23645),i=o.n(n)()((function(e){return e[1]}));i.push([e.id,".uk-textarea[data-v-923cbfb8] {\n  height: 134px;\n  background-color: transparent;\n  border: none;\n}\n.uk-textarea[data-v-923cbfb8]:focus {\n  background-color: transparent;\n}\n.preview-container[data-v-923cbfb8] {\n  box-sizing: border-box;\n  margin-top: 10px;\n  height: 76px;\n  width: 362px;\n  padding: 6px;\n  min-width: 100%;\n}\n.equation-help[data-v-923cbfb8] {\n  opacity: 0.3;\n}\n.equation-help[data-v-923cbfb8]:hover {\n  opacity: 0.6;\n}\n",""]);const r=i},10454:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>r});var n=o(23645),i=o.n(n)()((function(e){return e[1]}));i.push([e.id,".topic-popover-overlay {\n  display: block;\n  margin: 0;\n  padding: 0;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 1010;\n  background-color: transparent;\n  border: none;\n}\n",""]);const r=i},96874:e=>{e.exports=function(e,t,o){switch(o.length){case 0:return e.call(t);case 1:return e.call(t,o[0]);case 2:return e.call(t,o[0],o[1]);case 3:return e.call(t,o[0],o[1],o[2])}return e.apply(t,o)}},34865:(e,t,o)=>{var n=o(89465),i=o(77813),r=Object.prototype.hasOwnProperty;e.exports=function(e,t,o){var a=e[t];r.call(e,t)&&i(a,o)&&(void 0!==o||t in e)||n(e,t,o)}},89465:(e,t,o)=>{var n=o(38777);e.exports=function(e,t,o){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o}},21078:(e,t,o)=>{var n=o(62488),i=o(37285);e.exports=function e(t,o,r,a,u){var l=-1,c=t.length;for(r||(r=i),u||(u=[]);++l<c;){var p=t[l];o>0&&r(p)?o>1?e(p,o-1,r,a,u):n(u,p):a||(u[u.length]=p)}return u}},25970:(e,t,o)=>{var n=o(63012),i=o(79095);e.exports=function(e,t){return n(e,t,(function(t,o){return i(e,o)}))}},63012:(e,t,o)=>{var n=o(97786),i=o(10611),r=o(71811);e.exports=function(e,t,o){for(var a=-1,u=t.length,l={};++a<u;){var c=t[a],p=n(e,c);o(p,c)&&i(l,r(c,e),p)}return l}},10611:(e,t,o)=>{var n=o(34865),i=o(71811),r=o(65776),a=o(13218),u=o(40327);e.exports=function(e,t,o,l){if(!a(e))return e;for(var c=-1,p=(t=i(t,e)).length,s=p-1,v=e;null!=v&&++c<p;){var d=u(t[c]),f=o;if("__proto__"===d||"constructor"===d||"prototype"===d)return e;if(c!=s){var h=v[d];void 0===(f=l?l(h,d,v):void 0)&&(f=a(h)?h:r(t[c+1])?[]:{})}n(v,d,f),v=v[d]}return e}},56560:(e,t,o)=>{var n=o(75703),i=o(38777),r=o(6557),a=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:r;e.exports=a},38777:(e,t,o)=>{var n=o(10852),i=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=i},99021:(e,t,o)=>{var n=o(85564),i=o(45357),r=o(30061);e.exports=function(e){return r(i(e,void 0,n),e+"")}},37285:(e,t,o)=>{var n=o(62705),i=o(35694),r=o(1469),a=n?n.isConcatSpreadable:void 0;e.exports=function(e){return r(e)||i(e)||!!(a&&e&&e[a])}},45357:(e,t,o)=>{var n=o(96874),i=Math.max;e.exports=function(e,t,o){return t=i(void 0===t?e.length-1:t,0),function(){for(var r=arguments,a=-1,u=i(r.length-t,0),l=Array(u);++a<u;)l[a]=r[t+a];a=-1;for(var c=Array(t+1);++a<t;)c[a]=r[a];return c[t]=o(l),n(e,this,c)}}},30061:(e,t,o)=>{var n=o(56560),i=o(21275)(n);e.exports=i},21275:e=>{var t=Date.now;e.exports=function(e){var o=0,n=0;return function(){var i=t(),r=16-(i-n);if(n=i,r>0){if(++o>=800)return arguments[0]}else o=0;return e.apply(void 0,arguments)}}},75703:e=>{e.exports=function(e){return function(){return e}}},85564:(e,t,o)=>{var n=o(21078);e.exports=function(e){return(null==e?0:e.length)?n(e,1):[]}},78718:(e,t,o)=>{var n=o(25970),i=o(99021)((function(e,t){return null==e?{}:n(e,t)}));e.exports=i},60371:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>x});var n=o(2954),i=o(78152),r=o(46016),a=o(84374),u=o(18621),l=o(90435),c=o(54856),p=o(69361),s=o(67214),v=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function u(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,u)}l((n=n.apply(e,t||[])).next())}))};var d=o(53419),f=o(53775),h=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function u(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,u)}l((n=n.apply(e,t||[])).next())}))};const g=(0,n.aZ)({__name:"equation-editor",setup(e){const{topicRect:t,equationValue:o,saveEquation:g,openEquationHelp:x,generateEquaitonPreview:w}=(()=>{var e;const{createXapUrlByArrayBuffer:t,generateMathJaxSVG:o,executeAction:i,domRectForSelection:r,properties:d,selection:f}=(0,a.nZ)(),h=null===(e=f.value)||void 0===e?void 0:e.modelIds,g=(0,n.Fl)((()=>{var e,t;return null===(t=null===(e=d.value)||void 0===e?void 0:e.equation.value)||void 0===t?void 0:t.text}));return{topicRect:(0,n.Fl)((()=>{const{height:e,width:t,x:o,y:n}=r.value||{};return{height:e,width:t,left:o,top:n}})),equationValue:g,saveEquation:e=>v(void 0,void 0,void 0,(function*(){if(!e)return;if(e===g.value)return;const n=yield o(e),r=a.ZQ.getSVGUri(n),u=yield(0,p.qM)(r,1,"blob"),l=yield u.arrayBuffer(),c=yield t(l,".png"),v=URL.createObjectURL(u),{width:d}=yield(0,s.N8)(v);URL.revokeObjectURL(v);const f={text:e,fallbackImageResourcePath:null==c?void 0:c.slice(4),width:d};i({name:"mutateTarget:equation",payload:{topicIds:h,equation:f}})})),openEquationHelp:()=>{(0,u.L9)({eventCategory:"Equation",eventAction:"clickEquationHelp"}),l.ZP.fetch(c.lf.GO_EQUATION_HELP,{})},generateEquaitonPreview:e=>v(void 0,void 0,void 0,(function*(){if(!e)return;const t=yield o(e);return(new DOMParser).parseFromString(t,"image/svg+xml").firstChild}))}})(),{T:y}=(0,i.JE)(),{setPopoverEditorVisible:b}=(0,r.$)(),m=(0,n.iH)(""),k=(0,n.iH)(),_=(0,n.Fl)((()=>(0,r.$)().zenMode?(0,r.$)().zenModeNightMode:"dark"===(0,i.S)().appearance)),q=(0,f.Ds)((e=>h(this,void 0,void 0,(function*(){if(k.value&&"string"==typeof e){for(;k.value.hasChildNodes();)k.value.removeChild(k.value.lastChild);if(e=e.trim()){const t=window.getComputedStyle(k.value),o=parseFloat(t.height)-12,n=parseFloat(t.width)-12,i=yield w(e);let r=0,a=0;if(i){k.value.append(i);const e=window.getComputedStyle(i);r=parseFloat(e.height),a=parseFloat(e.width),k.value.removeChild(i)}const u=Math.min(o/r,n/a,1);i.style.height=r*u+"px",i.style.width=a*u+"px",k.value.append(i)}else{const e=document.createElement("span");e.classList.add("uk-text-bold"),e.style.opacity="0.3",e.style.fontSize="13px",e.innerText=y("Equation Preview"),k.value.append(e)}}}))),0);return(0,n.bv)((()=>{var e;m.value=null!==(e=o.value)&&void 0!==e?e:"",q(m.value),(0,u.L9)({eventCategory:"Equation",eventAction:""===m.value?"newEquation":"editEquation"})})),(0,n.Jd)((()=>h(this,void 0,void 0,(function*(){var e;yield g(m.value);""===(null!==(e=o.value)&&void 0!==e?e:"")&&(0,u.L9)({eventCategory:"Equation",eventAction:"saveEmptyEquation"})})))),(0,n.YP)((()=>(0,i.S)().language),(()=>q(m.value))),(0,n.YP)((()=>m.value),(()=>q(m.value))),{__sfc:!0,topicRect:t,equationValue:o,saveEquation:g,openEquationHelp:x,generateEquaitonPreview:w,$T:y,setPopoverEditorVisible:b,equation:m,previewContainer:k,EQUATION_PREVIEW_PADDING:6,isDarkMode:_,handleUpdatePreview:q,handleKeydown:e=>{"Tab"===e.code&&(e.preventDefault(),e.stopPropagation())},close:()=>h(this,void 0,void 0,(function*(){"equation"===(0,r.$)().popoverEditorVisible&&b("")})),TopicPopoverContainer:d.Z}}});o(85760);const x=(0,o(51900).Z)(g,(function(){var e=this,t=e._self._c,o=e._self._setupProxy;return t(o.TopicPopoverContainer,{attrs:{"popover-width":394,"popover-height":280,"topic-height":o.topicRect.height,"topic-width":o.topicRect.width,"topic-left":o.topicRect.left,"topic-top":o.topicRect.top},on:{"popover-close":o.close}},[t("div",{staticClass:"uk-padding uk-flex uk-flex-column uk-flex-middle uk-height-1-1"},[t("div",{staticClass:"uk-flex uk-flex-between uk-width-1-1 uk-flex-middle",staticStyle:{"margin-bottom":"12px"}},[t("span",{staticClass:"uk-text-bold uk-margin-remove-bottom",staticStyle:{"font-size":"14px","line-height":"14px"}},[e._v("\n        "+e._s(o.$T("Equation"))+"\n      ")]),e._v(" "),t("span",{staticClass:"equation-help uk-flex-no-shrink uk-flex-no-grow",staticStyle:{outline:"none"},attrs:{tabindex:"-1","uk-icon":"icon: question; ratio: 1.1"},on:{click:o.openEquationHelp}})]),e._v(" "),t("div",{staticClass:"uk-height-expand uk-width-1-1"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:o.equation,expression:"equation"}],staticClass:"uk-box-shadow-none uk-textarea uk-width-1-1 uk-height-1-1 uk-padding-remove",attrs:{autofocus:"",spellcheck:"false",placeholder:o.$T("Type or paste LaTeX")},domProps:{value:o.equation},on:{keydown:o.handleKeydown,input:function(e){e.target.composing||(o.equation=e.target.value)}}}),e._v(" "),t("div",{ref:"previewContainer",staticClass:"preview-container uk-flex uk-flex-center uk-flex-middle",style:{"background-color":o.isDarkMode?"rgba(255,255,255, .1)":"rgba(0,0,0, .02)",fill:o.isDarkMode?"white":"black"}})])])])}),[],!1,null,"923cbfb8",null).exports},53419:(e,t,o)=>{"use strict";o.d(t,{Z:()=>c});var n=o(2954),i=o(78718),r=o.n(i),a=o(84374),u=function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function u(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,u)}l((n=n.apply(e,t||[])).next())}))};const l=(0,n.aZ)({__name:"topic-popover-container",props:{topicHeight:null,topicWidth:null,topicLeft:null,topicTop:null,popoverWidth:null,popoverHeight:null,viewPortPadding:null,autoShowOnMounted:null},emits:["popover-close"],setup(e,{emit:t}){const o=e,i=(0,n.FN)(),l=(0,n.iH)(null),c=(0,n.Fl)((()=>{const{viewPortPadding:e}=o;return void 0===e?16:e})),p=(0,n.Fl)((()=>{const{autoShowOnMounted:e}=o;return void 0===e||e})),s=(0,n.Fl)((()=>({top:o.topicTop+"px",left:o.topicLeft+"px",width:o.topicWidth+"px",height:o.topicHeight+"px"}))),v=e=>{const t=e.getBoundingClientRect();return Object.assign({},r()(t,"top","left","right","bottom","width","height"),{offsetTop:e.offsetTop,offsetLeft:e.offsetLeft})},d=()=>{const e=document.querySelector("#editor-container");return e?v(e):null},f=()=>{const e=d();if(!e)return!1;const{popoverHeight:t,popoverWidth:n,topicTop:i,topicLeft:r,topicWidth:u,topicHeight:l}=o,p=r+d().left,s=i+d().top,v=e.offsetTop>s,f=e.offsetTop+e.height<l+s+t,h=p-(e.left+e.offsetLeft)<n/2-u/2,g=e.left+e.offsetLeft+e.width<p+u/2+n/2,x=l+t>e.height,w=u>e.width;let y=e.offsetLeft,b=e.offsetTop;v&&(b=s-c.value),f&&(b=s+l+o.popoverHeight-e.height+c.value),x&&(b=Math.max(l-e.height,0)+s+o.popoverHeight);const m=Math.max((o.popoverWidth-u)/2,0);if(h&&(y=p-e.left-c.value-m),g&&(y=p-e.left+u-e.width+m+c.value),w&&(y=p+m),v||f||h||g||x||w){const{moveViewport:e}=(0,a.nZ)();return e(y,b),!0}return!0},h=()=>u(this,void 0,void 0,(function*(){if(!(yield f()))return g(!1);g(!0)})),g=e=>{setTimeout((()=>{i.proxy.$withUIKit((t=>{const o=t.pop(l.value);o&&(e?o.show():o.hide())}))}),50)};return(0,n.bv)((()=>{p.value&&h(),(0,n.Y3)((()=>{i.proxy.$withUIKit((e=>{e.util.on(l.value,"hidden",(()=>{t("popover-close")}))}))}))})),{__sfc:!0,props:o,emits:t,vm:i,popoverEl:l,viewPortPadding:c,isAutoShowOnMounted:p,topicRectStyle:s,getElementRect:v,getWindowBounds:d,moveViewport:f,showPopover:h,_togglePopover:g}}});o(19455);const c=(0,o(51900).Z)(l,(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"focus-contexts",rawName:"v-focus-contexts:group",value:["focus.popover"],expression:"['focus.popover']",arg:"group"}]},[t("div",{staticClass:"uk-position-absolute",style:e._self._setupProxy.topicRectStyle}),e._v(" "),t("div",{ref:"popoverEl",style:{width:e.popoverWidth+"px",height:e.popoverHeight+"px"??"auto"},attrs:{"uk-popover":"","data-cls-overlay":"topic-popover-overlay"}},[e._t("default")],2)])}),[],!1,null,null,null).exports},85760:(e,t,o)=>{var n=o(27071);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,o(45346).Z)("53276064",n,!0,{})},19455:(e,t,o)=>{var n=o(10454);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,o(45346).Z)("b6d891a8",n,!0,{})}}]);