(global.webpackChunkxmind_vana=global.webpackChunkxmind_vana||[]).push([[5691],{84327:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>r});var n=o(23645),i=o.n(n)()((function(t){return t[1]}));i.push([t.id,".label-editor-textarea {\n  border: none !important;\n  box-shadow: none !important;\n  background-color: transparent !important;\n}\n",""]);const r=i},10454:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>r});var n=o(23645),i=o.n(n)()((function(t){return t[1]}));i.push([t.id,".topic-popover-overlay {\n  display: block;\n  margin: 0;\n  padding: 0;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 1010;\n  background-color: transparent;\n  border: none;\n}\n",""]);const r=i},96874:t=>{t.exports=function(t,e,o){switch(o.length){case 0:return t.call(e);case 1:return t.call(e,o[0]);case 2:return t.call(e,o[0],o[1]);case 3:return t.call(e,o[0],o[1],o[2])}return t.apply(e,o)}},34865:(t,e,o)=>{var n=o(89465),i=o(77813),r=Object.prototype.hasOwnProperty;t.exports=function(t,e,o){var l=t[e];r.call(t,e)&&i(l,o)&&(void 0!==o||e in t)||n(t,e,o)}},89465:(t,e,o)=>{var n=o(38777);t.exports=function(t,e,o){"__proto__"==e&&n?n(t,e,{configurable:!0,enumerable:!0,value:o,writable:!0}):t[e]=o}},21078:(t,e,o)=>{var n=o(62488),i=o(37285);t.exports=function t(e,o,r,l,a){var s=-1,u=e.length;for(r||(r=i),a||(a=[]);++s<u;){var p=e[s];o>0&&r(p)?o>1?t(p,o-1,r,l,a):n(a,p):l||(a[a.length]=p)}return a}},25970:(t,e,o)=>{var n=o(63012),i=o(79095);t.exports=function(t,e){return n(t,e,(function(e,o){return i(t,o)}))}},63012:(t,e,o)=>{var n=o(97786),i=o(10611),r=o(71811);t.exports=function(t,e,o){for(var l=-1,a=e.length,s={};++l<a;){var u=e[l],p=n(t,u);o(p,u)&&i(s,r(u,t),p)}return s}},10611:(t,e,o)=>{var n=o(34865),i=o(71811),r=o(65776),l=o(13218),a=o(40327);t.exports=function(t,e,o,s){if(!l(t))return t;for(var u=-1,p=(e=i(e,t)).length,c=p-1,d=t;null!=d&&++u<p;){var v=a(e[u]),f=o;if("__proto__"===v||"constructor"===v||"prototype"===v)return t;if(u!=c){var h=d[v];void 0===(f=s?s(h,v,d):void 0)&&(f=l(h)?h:r(e[u+1])?[]:{})}n(d,v,f),d=d[v]}return t}},56560:(t,e,o)=>{var n=o(75703),i=o(38777),r=o(6557),l=i?function(t,e){return i(t,"toString",{configurable:!0,enumerable:!1,value:n(e),writable:!0})}:r;t.exports=l},38777:(t,e,o)=>{var n=o(10852),i=function(){try{var t=n(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=i},99021:(t,e,o)=>{var n=o(85564),i=o(45357),r=o(30061);t.exports=function(t){return r(i(t,void 0,n),t+"")}},37285:(t,e,o)=>{var n=o(62705),i=o(35694),r=o(1469),l=n?n.isConcatSpreadable:void 0;t.exports=function(t){return r(t)||i(t)||!!(l&&t&&t[l])}},45357:(t,e,o)=>{var n=o(96874),i=Math.max;t.exports=function(t,e,o){return e=i(void 0===e?t.length-1:e,0),function(){for(var r=arguments,l=-1,a=i(r.length-e,0),s=Array(a);++l<a;)s[l]=r[e+l];l=-1;for(var u=Array(e+1);++l<e;)u[l]=r[l];return u[e]=o(s),n(t,this,u)}}},30061:(t,e,o)=>{var n=o(56560),i=o(21275)(n);t.exports=i},21275:t=>{var e=Date.now;t.exports=function(t){var o=0,n=0;return function(){var i=e(),r=16-(i-n);if(n=i,r>0){if(++o>=800)return arguments[0]}else o=0;return t.apply(void 0,arguments)}}},75703:t=>{t.exports=function(t){return function(){return t}}},85564:(t,e,o)=>{var n=o(21078);t.exports=function(t){return(null==t?0:t.length)?n(t,1):[]}},78718:(t,e,o)=>{var n=o(25970),i=o(99021)((function(t,e){return null==t?{}:n(t,e)}));t.exports=i},75691:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>s});var n=o(2954),i=o(96160);var r=o(21029),l=o(53419);const a=(0,n.aZ)({__name:"label-editor",props:{topicId:null,topicRect:null},emits:["popover-close"],setup(t,{emit:e}){const o=t,{labels:a,content:s,topicRect:u,mostlyUsedLabels:p,updateTopicLabel:c,addLabelIntoContent:d}=(()=>{var t;const{syncedProperties:e,activeSheet:o,domRectForSelection:r,executeAction:l,selection:a}=(0,i.nZ)(),s=(0,n.Fl)((()=>{const{height:t,width:e,x:o,y:n}=r.value||{height:0,width:0,x:0,y:0};return{height:t,width:e,left:o||0,top:n||0}})),u=(0,n.Fl)((()=>{var t;return null===(t=a.value)||void 0===t?void 0:t.modelIds})),p=(0,n.Fl)((()=>{var t,o;return null===(o=null===(t=e.value)||void 0===t?void 0:t.topicLabel)||void 0===o?void 0:o.value})),c=(0,n.iH)(null===(t=p.value)||void 0===t?void 0:t.toString()),d=(0,n.Fl)((()=>i.HG.allLabelsFromSheet(o.value)));return{labels:p,content:c,topicRect:s,mostlyUsedLabels:d,updateTopicLabel:t=>{l({name:"mutateTarget:topicLabel",payload:{topicIds:u.value,label:t}})},addLabelIntoContent:t=>{if(!t)return;const e=c.value.split(/,|，/).filter((t=>!!t));e.push(t),c.value=e.join(",")}}})(),{setPopoverEditorVisible:v}=(0,r.$)(),f=(0,n.Fl)((()=>{var t;return null!==(t=o.topicRect)&&void 0!==t?t:u.value})),h={inserted:function(t){setTimeout((()=>{t.focus()}),100)}},m=(0,n.iH)(null),g=(0,n.iH)(!1),b=()=>{const t=s.value.replace(/，/g,",").split(",").map((t=>t.trim())).filter((t=>t.length>0)).filter(((t,e,o)=>o.indexOf(t)===e)).join(",");c(t),"label"===(0,r.$)().popoverEditorVisible&&v(""),e("popover-close",{topicId:o.topicId,labels:t?t.split(","):[]})},x=(0,n.Fl)((()=>p.value.length));return{__sfc:!0,props:o,emit:e,labels:a,content:s,topicRect:u,mostlyUsedLabels:p,updateTopicLabel:c,addLabelIntoContent:d,setPopoverEditorVisible:v,computedTopicRect:f,vFocus:h,labelTextarea:m,isInputMethodInputting:g,handleCompositionstart:()=>{g.value=!0},handleCompositionend:()=>{g.value=!1},saveAndClose:b,handleKeydown:t=>{if("Enter"===t.code){if(t.preventDefault(),t.stopPropagation(),g.value)return;b()}"Tab"===t.code&&(t.preventDefault(),t.stopPropagation())},handleClickLabel:t=>{d(t),setTimeout((()=>{const t=m.value.value.length;m.value.focus(),m.value.setSelectionRange(t,t)}))},mostlyUsedLabelsVisible:x,TopicPopoverContainer:l.Z}}});o(46314);const s=(0,o(51900).Z)(a,(function(){var t=this,e=t._self._c,o=t._self._setupProxy;return e(o.TopicPopoverContainer,{directives:[{name:"show",rawName:"v-show",value:0!==o.computedTopicRect.width,expression:"computedTopicRect.width !== 0"}],attrs:{"topic-left":o.computedTopicRect.left,"topic-height":o.computedTopicRect.height,"topic-top":o.computedTopicRect.top,"topic-width":o.computedTopicRect.width,"popover-width":280,"popover-height":o.mostlyUsedLabelsVisible?223:148},on:{"popover-close":o.saveAndClose}},[e("div",{staticClass:"uk-flex uk-flex-column uk-flex-middle uk-height-1-1"},[e("div",{staticClass:"uk-padding uk-flex uk-flex-column uk-flex-middle uk-width-1-1",staticStyle:{height:"148px"}},[e("h4",{staticClass:"uk-margin-small-bottom uk-width-1-1 uk-text-bold"},[t._v("\n        "+t._s(t.$T("Label"))+"\n      ")]),t._v(" "),e("div",{staticClass:"uk-height-expand uk-width-1-1"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:o.content,expression:"content"},{name:"focus",rawName:"v-focus"}],ref:"labelTextarea",staticClass:"uk-textarea uk-width-1-1 uk-height-1-1 uk-padding-remove uk-margin-remove label-editor-textarea",attrs:{placeholder:o.labels?.length?"":t.$T("Enter labels, separated by commas")},domProps:{value:o.content},on:{compositionstart:o.handleCompositionstart,compositionend:o.handleCompositionend,keydown:o.handleKeydown,input:function(t){t.target.composing||(o.content=t.target.value)}}})])]),t._v(" "),o.mostlyUsedLabelsVisible?[e("div",{staticClass:"uk-width-1-1 uk-padding uk-padding-remove-vertical"},[e("hr",{staticClass:"uk-separator uk-width-1-1"})]),t._v(" "),e("div",{staticClass:"uk-height-expand uk-width-1-1 uk-mostly-used-labels uk-padding",staticStyle:{"padding-top":"12px"}},[e("div",{staticClass:"uk-mostly-used-labels-container"},t._l(o.mostlyUsedLabels,(function(n){return e("div",{key:n,staticClass:"uk-mostly-used-labels-item",on:{click:function(t){return o.handleClickLabel(n)}}},[t._v("\n            "+t._s(n)+"\n          ")])})),0)])]:t._e()],2)])}),[],!1,null,null,null).exports},53419:(t,e,o)=>{"use strict";o.d(e,{Z:()=>u});var n=o(2954),i=o(78718),r=o.n(i),l=o(96160),a=function(t,e,o,n){return new(o||(o=Promise))((function(i,r){function l(t){try{s(n.next(t))}catch(t){r(t)}}function a(t){try{s(n.throw(t))}catch(t){r(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(l,a)}s((n=n.apply(t,e||[])).next())}))};const s=(0,n.aZ)({__name:"topic-popover-container",props:{topicHeight:null,topicWidth:null,topicLeft:null,topicTop:null,popoverWidth:null,popoverHeight:null,viewPortPadding:null,autoShowOnMounted:null},emits:["popover-close"],setup(t,{emit:e}){const o=t,i=(0,n.FN)(),s=(0,n.iH)(null),u=(0,n.Fl)((()=>{const{viewPortPadding:t}=o;return void 0===t?16:t})),p=(0,n.Fl)((()=>{const{autoShowOnMounted:t}=o;return void 0===t||t})),c=(0,n.Fl)((()=>({top:o.topicTop+"px",left:o.topicLeft+"px",width:o.topicWidth+"px",height:o.topicHeight+"px"}))),d=t=>{const e=t.getBoundingClientRect();return Object.assign({},r()(e,"top","left","right","bottom","width","height"),{offsetTop:t.offsetTop,offsetLeft:t.offsetLeft})},v=()=>{const t=document.querySelector("#editor-container");return t?d(t):null},f=()=>{const t=v();if(!t)return!1;const{popoverHeight:e,popoverWidth:n,topicTop:i,topicLeft:r,topicWidth:a,topicHeight:s}=o,p=r+v().left,c=i+v().top,d=t.offsetTop>c,f=t.offsetTop+t.height<s+c+e,h=p-(t.left+t.offsetLeft)<n/2-a/2,m=t.left+t.offsetLeft+t.width<p+a/2+n/2,g=s+e>t.height,b=a>t.width;let x=t.offsetLeft,w=t.offsetTop;d&&(w=c-u.value),f&&(w=c+s+o.popoverHeight-t.height+u.value),g&&(w=Math.max(s-t.height,0)+c+o.popoverHeight);const y=Math.max((o.popoverWidth-a)/2,0);if(h&&(x=p-t.left-u.value-y),m&&(x=p-t.left+a-t.width+y+u.value),b&&(x=p+y),d||f||h||m||g||b){const{moveViewport:t}=(0,l.nZ)();return t(x,w),!0}return!0},h=()=>a(this,void 0,void 0,(function*(){if(!(yield f()))return m(!1);m(!0)})),m=t=>{setTimeout((()=>{i.proxy.$withUIKit((e=>{const o=e.pop(s.value);o&&(t?o.show():o.hide())}))}),50)};return(0,n.bv)((()=>{p.value&&h(),(0,n.Y3)((()=>{i.proxy.$withUIKit((t=>{t.util.on(s.value,"hidden",(()=>{e("popover-close")}))}))}))})),{__sfc:!0,props:o,emits:e,vm:i,popoverEl:s,viewPortPadding:u,isAutoShowOnMounted:p,topicRectStyle:c,getElementRect:d,getWindowBounds:v,moveViewport:f,showPopover:h,_togglePopover:m}}});o(19455);const u=(0,o(51900).Z)(s,(function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"focus-contexts",rawName:"v-focus-contexts:group",value:["focus.popover"],expression:"['focus.popover']",arg:"group"}]},[e("div",{staticClass:"uk-position-absolute",style:t._self._setupProxy.topicRectStyle}),t._v(" "),e("div",{ref:"popoverEl",style:{width:t.popoverWidth+"px",height:t.popoverHeight+"px"??"auto"},attrs:{"uk-popover":"","data-cls-overlay":"topic-popover-overlay"}},[t._t("default")],2)])}),[],!1,null,null,null).exports},46314:(t,e,o)=>{var n=o(84327);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[t.id,n,""]]),n.locals&&(t.exports=n.locals);(0,o(45346).Z)("7f507399",n,!0,{})},19455:(t,e,o)=>{var n=o(10454);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[t.id,n,""]]),n.locals&&(t.exports=n.locals);(0,o(45346).Z)("b6d891a8",n,!0,{})}}]);